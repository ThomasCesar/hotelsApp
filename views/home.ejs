<%- include('partials/header') %>

<%- include('partials/nav') %>

<div class="app">

    <div class="banner-hero">
        <div>
            <h1>Trouver un hotel qui vous convient.</h1>
            <p>
                Lorem ipsum dolor sit amet consectetur adipisicing elit. Vitae, placeat doloremque, sapiente accusamus
                commodium tempore.
            </p>
            <button class="btn-primary">
                Do something
                <i class="las la-arrow-right"></i>
            </button>
        </div>
        <div></div>
    </div>

    <form class="searchbox">
        <div>
            <p>Du</p>
            <input type="date" name="" placeholder="Du">
        </div>
        <div>
            <p>Au</p>
            <input type="date" name="" placeholder="Au">
        </div>
        <div>
            <button class="btn-primary">
                <i class="las la-hotel"></i> Chercher
            </button>
        </div>

    </form>
    <div class="hotels-container">
        <h1>Vos hotels</h1>
        <div class="hotels-list" id="hotelslist"></div>
        <div class="hotels-detectbottom" id="detectbottom"></div>
    </div>

</div>

<%- include('partials/footer') %>

<script>

    const detectbottom = document.getElementById('detectbottom');
    const hotelslist = document.getElementById('hotelslist');
    (function() {
        
    fetch(`https://jsonplaceholder.typicode.com/posts`)
    .then((response) => response.json())
    .then((results) => {
        randomQuotes = results;
        let nbRandomQuotes = randomQuotes.length;

        // initialise observer

        let observer = new IntersectionObserver( 
            ()=>{
                for (let index = 0; index < 5; index++) 
                {
                    let datapayload = randomQuotes[ Math.floor( Math.random() * randomQuotes.length ) ];
                    datapayload['image'] = 'https://picsum.photos/id/' + ( Math.floor( Math.random() * 1000 ) + 1 ) + '/200';
                    hotelslist.innerHTML += ''+
                    '<div class="hotel">'+
                        '<img src="' + datapayload.image + '">'+
                        '<div class="hotel-text">'+
                            '<p>' + datapayload.name + '</p>'+
                            '<p>' + datapayload.desc + '</p>'+
                        '</div>'+
                        '<div class="hotel-button">'+
                            '<button class="btn-primary btn-small">Voir plus</button>'+
                        '</div>'+
                    '</div>';
                }
            }, 
            { 
                threshold : [ .1 ] 
            } 
        );
        observer.observe( detectbottom );

    });
})();
</script>